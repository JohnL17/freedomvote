{% extends 'index.html' %}

{% load i18n staticfiles %}

{% block 'scripts' %}
<script src="{% static 'candidates.js' %}"></script>
{% endblock %}

{% block 'content' %}

<form method="get" class="form-inline text-right row">
    <div class="filter">
        {% if 'evaluate' in request.GET.keys %}<input type="hidden" name="evaluate">{% endif %}
        <select name="category" class="form-control">
            <option value="0">{% trans 'sort_by_category' %}...</option>
            <option disabled>─────────────────</option>
            {% for category in categories %}
            <option value="{{ category.id }}" {% if request.GET.category == category.id|slugify %}selected{% endif %}>
                {{category.name}}
            </option>
            {% endfor %}
        </select>
        <input
         name="search"
         type="text"
         class="form-control"
         placeholder="{% trans 'search' %}..."
         value="{{request.GET.search}}"
        >
        <select name="state" class="form-control">
            <option value="0">{% trans 'filter_by_state' %}...</option>
            <option disabled>─────────────────</option>
            {% for state in states %}
            <option value="{{ state.id }}" {% if request.GET.state == state.id|slugify %}selected{% endif %}>
                {{state.name}}
            </option>
            {% endfor %}
        </select>
        <input type="submit" class="btn btn-primary" value="{% trans 'filter' %}">
    </div>
</form>
<div class="row">
    <table class="table table-striped">
        {% for politician in politicians %}
            {% include 'core/candidate_row.html' %}
        {% endfor %}
    </table>
    <nav class="text-center">
        <ul class="pagination">
            <li {% if not politicians.has_previous %}class="disabled"{% endif %}>
                {% if politicians.has_previous %}
                <a href="{% url 'candidates' %}?page={{ politicians.previous_page_number }}{% for k, v in request.GET.iteritems %}&amp;{{k}}={{v}}{%endfor%}"><span aria-hidden="true">&laquo;</span></a>
                {% else %}
                    <a><span aria-hidden="true">&laquo;</span></a>
                {% endif %}
            </li>
            {% for num in politicians.paginator.page_range %}
            <li {% if politicians.number == num %}class="active"{% endif %}>
              <a href="{% url 'candidates' %}?page={{num}}{% for k, v in request.GET.iteritems %}&amp;{{k}}={{v}}{%endfor%}">{{num}}{% if politicians.number == num %} <span class="sr-only">(current)</span>{% endif %}</a>
            </li>
            {% endfor %}
            <li {% if not politicians.has_next %}class="disabled"{% endif %}>
                {% if politicians.has_next %}
                    <a href="{% url 'candidates' %}?page={{ politicians.next_page_number }}{% for k, v in request.GET.iteritems %}&amp;{{k}}={{v}}{%endfor%}"><span aria-hidden="true">&raquo;</span></a>
                {% else %}
                    <a><span aria-hidden="true">&raquo;</span></a>
                {% endif %}
            </li>
        </ul>
    </nav>
</div>
{% endblock %}
